<!DOCTYPE html>
<html lang="en">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      function pollForNewData(
        sURL,
        pollDelayInMS,
        fNewDataCallBack,
        fDoneCallBack
      ) {
        var request = new XMLHttpRequest();
        //  request we will be doing
        request.open("GET", sURL);

        // callback when data is loaded
        request.onload = function () {
          // I assumed that the data is a JSON transmission, lets make it a native JS
          // Object
          var responseObj = JSON.parse(request.responseText);
          if (responseObj.done === true) {
            // if done is true lets invoke the done callback
            fDoneCallBack();
          } else {
            // if its not done, lets invoke new data callback with the response object
            fNewDataCallBack(responseObj);
            // we want to run the process again! but wait pollDelayInMS milliseconds.
            setTimeout(function () {
              pollForNewData(
                sURL,
                pollDelayInMS,
                fNewDataCallBack,
                fDoneCallBack
              );
            }, pollDelayInMS);
          }
        };
        // let kick off the process.
        request.send();
      }

      const newDataCB = (response) => {
        // this function does two things, it'll log the response obj to the
        // browser debugger tool and it'll append a new robot
        console.log(response);
        $("#robot-list").append(
          `<li><img style="height: 10vh;" src="${response.robot}" alt="a robot"></li>`
        );
      };

      // this done callback for sake of expediency just does a windows.alert
      const doneCB = () => window.alert("No more robots!");

      $(document).ready(() => {
        $("#button").click(() => {
          // $("#robot-list").append(
          //   `<li><img style="height: 15vh;" src="https://robohash.org/${Date.now()}" alt="a robot"></li>`
          // );
          const url = "https://chuck-loop-ajax.herokuapp.com/robots";

          // here is the kickoff of the function you requested

          // url = url we are sending a 'GET' request to
          // 500 = MS i wanted to wait between polling
          // newDataCB = function that will be invoked (notice it isn't invoked now)
          //             when there is new robots and we aint done
          // doneCB = function (not invoked) that will be invoked when we
          //          receive from the server {"done": true}

          pollForNewData(url, 500, newDataCB, doneCB);
        });
      });
    </script>
    <h1>Robot Gatherer!</h1>
    <h2>List of robots:</h2>
    <ol id="robot-list">
      <!-- <li><img src="https://robohash.org/1321" alt="a robot" /></li> -->
    </ol>
    <button id="button">Gather a random set of robots</button>
  </body>
</html>
